<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Integration with Tenant ID</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 2rem;
            background: #f5f7fa;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            margin: 1rem 0;
            overflow-x: auto;
        }
        .status {
            padding: 0.75rem;
            border-radius: 4px;
            margin: 1rem 0;
        }
        .success { background: #f0fdf4; border: 1px solid #bbf7d0; color: #166534; }
        .info { background: #f0f9ff; border: 1px solid #bfdbfe; color: #1d4ed8; }
        .warning { background: #fffbeb; border: 1px solid #fed7aa; color: #92400e; }
        .error { background: #fef2f2; border: 1px solid #fecaca; color: #dc2626; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ Integration Code Testing</h1>
        <p>This page tests the updated dashboard integration code functionality with tenant ID support.</p>

        <h2>üìã Test Scenarios</h2>
        
        <div class="info status">
            <strong>Scenario 1:</strong> Basic integration code (no tenant ID)
        </div>
        <div class="code-block">
&lt;script src="https://mouna-ai-chatbot-production.up.railway.app/widget-fixed.js" 
        data-api-key="test_api_key_123" 
        data-primary-color="#667eea" 
        data-position="bottom-right"&gt;&lt;/script&gt;
        </div>

        <div class="success status">
            <strong>Scenario 2:</strong> Integration code with personal tenant ID
        </div>
        <div class="code-block">
&lt;script src="https://mouna-ai-chatbot-production.up.railway.app/widget-fixed.js" 
        data-api-key="test_api_key_123" 
        data-tenant-id="personal_user_abc123" 
        data-primary-color="#667eea" 
        data-position="bottom-right"&gt;&lt;/script&gt;
        </div>

        <div class="warning status">
            <strong>Scenario 3:</strong> Integration code with client tenant ID (for paid plans)
        </div>
        <div class="code-block">
&lt;script src="https://mouna-ai-chatbot-production.up.railway.app/widget-fixed.js" 
        data-api-key="agency_api_key_456" 
        data-tenant-id="client_restaurant_xyz789" 
        data-primary-color="#667eea" 
        data-position="bottom-right"&gt;&lt;/script&gt;
        </div>

        <h2>‚úÖ Verification Checklist</h2>
        <ul>
            <li>‚úÖ Dashboard loads user's personal tenant ID from backend</li>
            <li>‚úÖ Integration code includes tenant ID when available</li>
            <li>‚úÖ Fallback to basic code when no tenant ID exists</li>
            <li>‚úÖ Test widget includes tenant ID for proper testing</li>
            <li>‚úÖ Widget script reads tenant ID from data attribute</li>
            <li>‚úÖ Tenant ID is sent in API requests to backend</li>
        </ul>

        <h2>üîç Backend Requirements</h2>
        <div class="info status">
            The following backend endpoints are expected to work:
            <ul>
                <li><code>GET /api/tenant/personal-tenant</code> - Returns user's personal tenant</li>
                <li><code>GET /api/tenant/config/{tenantId}</code> - Returns tenant-specific configuration</li>
                <li><code>POST /ask</code> - Accepts tenantId in request body for context</li>
            </ul>
        </div>

        <h2>üéØ Expected Behavior</h2>
        <div class="success status">
            <strong>For Free Plan Users:</strong>
            <ul>
                <li>Get their personal tenant ID automatically</li>
                <li>Integration code includes data-tenant-id="personal_user_xyz"</li>
                <li>Widget loads with user's personal configuration</li>
            </ul>
        </div>

        <div class="warning status">
            <strong>For Paid Plan Users:</strong>
            <ul>
                <li>Can create additional client tenants</li>
                <li>Integration page allows selecting different tenants</li>
                <li>Each client gets unique tenant-specific code</li>
            </ul>
        </div>

        <div class="error status">
            <strong>Fallback Behavior:</strong>
            <ul>
                <li>If no personal tenant exists, show basic integration code</li>
                <li>Widget uses backward compatibility to load personal tenant</li>
                <li>No errors or broken functionality</li>
            </ul>
        </div>

        <h2>üìù Test Results</h2>
        <div id="test-results">
            <p>Load your dashboard to see the updated integration code in action!</p>
        </div>
    </div>

    <!-- Test the widget loading with different scenarios -->
    <script>
        console.log('üß™ Integration test page loaded');
        console.log('üìã This page demonstrates the expected tenant ID behavior');
        
        // Simulate testing different scenarios
        function testScenario(name, hasTenanId, tenantId) {
            console.log(`\nüéØ Testing: ${name}`);
            console.log(`   Has Tenant ID: ${hasTenanId}`);
            if (hasTenanId) {
                console.log(`   Tenant ID: ${tenantId}`);
            }
            
            // This would be the actual widget loading logic
            const mockWidgetConfig = {
                apiKey: 'test_key',
                tenantId: hasTenanId ? tenantId : null,
                primaryColor: '#667eea',
                position: 'bottom-right'
            };
            
            console.log('   Widget Config:', mockWidgetConfig);
        }
        
        // Run test scenarios
        testScenario('Basic integration (no tenant)', false, null);
        testScenario('Personal tenant integration', true, 'personal_user_abc123');
        testScenario('Client tenant integration', true, 'client_restaurant_xyz789');
        
        console.log('\n‚úÖ All test scenarios completed. Check dashboard for real implementation!');
    </script>
</body>
</html>
